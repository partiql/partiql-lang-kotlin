suite::{
  name: "suite_00",
  session: {
    catalog: "default",   // session catalog
    path: ["tpc_ds"],     // session path
    vars: {},             // session variables
  },
  tests: {
    '0000': {
      statement: '''
        SELECT ss_ticket_number, ss_quantity, ss_sold_date_sk
        FROM store_sales
      ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields: [
            {
              name: "ss_ticket_number",
              type: "string",
            },
            {
              name: "ss_quantity",
              type: ["int32", "null"],
            },
            {
              name: "ss_sold_date_sk",
              type: ["date", "null"],
            },
          ],
        },
      },
    },
    '0001': {
      statement: '''
        SELECT ss_ticket_number, ss_quantity, ss_sold_date_sk
        FROM store_sales
        WHERE ss_sold_date_sk > DATE_ADD(DAY, -30, UTCNOW())
      ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields: [
            {
              name: "ss_ticket_number",
              type: "string",
            },
            {
              name: "ss_quantity",
              type: ["int32", "null"],
            },
            {
              name: "ss_sold_date_sk",
              type: ["date", "null"],
            },
          ],
        },
      },
    },
    '0002': {
      statement: '''
        SELECT (ss_wholesale_cost + 10 < ss_list_price) AS x
        FROM store_sales
      ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields: [
            {
              name: "x",
              type: ["bool", "null"],
            },
          ],
        },
      },
    },
    '0003': {
      statement: '''
      SELECT
        ss_quantity, -- This is a nullable int32
        CASE (ss_quantity) -- This case statement will always return a non-nullable string
          WHEN 0 THEN 'Did not sell anything!'
          WHEN 1 THEN 'Sold a single item!'
          ELSE 'Sold multiple items!'
        END AS ss_quantity_description_1,
        CASE (ss_quantity)
          WHEN 0 THEN 'Hello' -- sometimes STRING
          WHEN 1 THEN 1.0 -- sometimes DECIMAL
          WHEN 2 THEN 2 -- sometimes INT
          -- There isn't an else here, so the output should be nullable as well.
        END AS ss_quantity_description_2,
        CASE (ss_quantity)
          WHEN 0 THEN 'Hello' -- ss_quantity will be cast to an INT for comparison
          WHEN 'not an int32' THEN 'not cast-able' -- cannot be cast!
          ELSE 'fallback'
          -- There is an ELSE here, so the output should NOT be nullable.
        END AS ss_quantity_description_3
      FROM store_sales;
    ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields: [
            {
              name: "ss_quantity",
              type: ["int32", "null"]
            },
            {
              name: "ss_quantity_description_1",
              type: ["string"]
            },
            {
              name: "ss_quantity_description_2",
              type: ["string", "decimal", "int", "null"]
            },
          ]
        }
      }
    },
    // TODO: Add support for SELECT * so we can assert on the schema
    '0004': {
      statement: '''
        SELECT *
        FROM
            tpc_ds.store AS store
          LEFT JOIN
            tpc_ds.store_returns AS returns
          ON s_store_sk = sr_store_sk
      ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields:[
            {
              name:"s_store_sk",
              type:"string"
            },
            {
              name:"s_store_id",
              type:"string"
            },
            {
              name:"s_rec_start_date",
              type:[
                "date",
                "null"
              ]
            },
            {
              name:"s_rec_end_date",
              type:[
                "date",
                "null"
              ]
            },
            {
              name:"s_closed_date_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_store_name",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_number_employees",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"s_floor_space",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"s_hours",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_manager",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_market_id",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"s_geography_class",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_market_desc",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_market_manager",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_division_id",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"s_division_name",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_company_id",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"s_company_name",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_street_number",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_street_name",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_street_type",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_suite_number",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_city",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_county",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_state",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_zip",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_country",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"s_gmt_offset",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"s_tax_precentage",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_returned_date_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_return_time_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_item_sk",
              type:"string"
            },
            {
              name:"sr_customer_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_cdemo_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_hdemo_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_addr_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_store_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_reason_sk",
              type:[
                "null",
                "string"
              ]
            },
            {
              name:"sr_ticket_number",
              type:"string"
            },
            {
              name:"sr_return_quantity",
              type:[
                "int32",
                "null"
              ]
            },
            {
              name:"sr_return_amt",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_return_tax",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_return_amt_inc_tax",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_fee",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_return_ship_cost",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_refunded_cash",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_reversed_charge",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_store_credit",
              type:[
                "float64",
                "null"
              ]
            },
            {
              name:"sr_net_loss",
              type:[
                "float64",
                "null"
              ]
            }
          ]
        }
      }
    },
    '0005': {
      statement: '''
        SELECT item.i_rec.*, item.i_rec.i_rec_start_date FROM pql.item AS item
      ''',
      schema: {
        type: "bag",
        items: {
          type: "struct",
          fields:[
            {
              name:"i_rec_start_date",
              type:[
                "int64",
                "null"
              ]
            },
            {
              name:"i_rec_end_date",
              type:[
                "int64",
                "null"
              ]
            }
          ]
        }
      }
    },
  },
}
