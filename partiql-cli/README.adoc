= PartiQL CLI

Command Line Interface for executing PartiQL queries. For more information, please see the CLI tutorials on our xref:https://github.com/partiql/partiql-lang-kotlin/wiki[wiki].

== Usage

This section shows how the _**partiql**_ utility can be used as both a command-line tool and interactive shell.

[source,shell]
----
# interactive shell
partiql                     # No arguments
partiql -d=/path/to/db      # Launch an interactive shell for the database in /path/to/db
partiql sample.ion    # Load sample.ion into the database environment as the binding `stdin`
partiql sample.csv    # '' format derived from extension
partiql -e sample.env    # Load partiQL literal data into partiQL shell

# stdin
cat sample.ion | partiql -f ion    # Load from stdin with the specified input format (-f) Ion.

# program string
partiql 'SELECT * FROM stdin' sample.ion
cat sample.ion | partiql -f ion 'SELECT * FROM stdin'

# program script
#   > cat script.sql
#   > SELECT * FROM stdin
partiql -q script.sql sample.ion
cat sample.ion | partiql -f ion 'SELECT * FROM stdin'
----

[source,shell,subs=normal]
----
man partiql

**NAME**
    **partiql** -- PartiQL command-line utility

**SYNOPSIS**
    **partiql** [options] ['statement'|-i file] [file ...]

**DESCRIPTION**
    The **partiql** command-line utility executes queries against the given input files.
    Execute **partiql** without a query to launch the database shell.
    The following options are available:

**OPTIONS**
    -d file, --dir=file
        The database directory.

    -e file, --env=file
        Load PartiQL literal data as default catalog data

    -f format, --format=format
        Specify the input:output data format.

    -i file, --include=file
        Reads input from the file and executes it.

    --strict
        Strict mode (type-checking) throws runtime exceptions on mistyped operations.

**Loading PartiQL Environment files**
    The PartiQL environment files are formatted as PartiQL literal and expected to be a single struct where each key-value pair corresponds to a new table in the default catalog. You can load environment file into partiql interactive shell and run query against the tables.

    For example, start the shell with "partiql -e Tutorial/code/q1.env", which will load the following table into default catalog.

    Data:
+++
    {
        'hr': {
            'employees': <<
                { 'id': 3, 'name': 'Bob Smith',   'title': null },
                { 'id': 4, 'name': 'Susan Smith', 'title': 'Dev Mgr' },
                { 'id': 6, 'name': 'Jane Smith',  'title': 'Software Eng 2'}
            >>
        }
    }
+++
    Query:
+++
    SELECT e.id,
           e.name AS employeeName,
           e.title AS title
    FROM hr.employees e
    WHERE e.title = 'Dev Mgr'
+++

    Output:
+++
    <<
      {
        'id': 4,
        'employeeName': 'Susan Smith',
        'title': 'Dev Mgr'
      }
    >>
    ---
    OK!
+++

----


== Debugging

You can attach a JDWP debugger to the shell by running with JAVA_OPTS set.

.Debugging
[source, shell]
----
JAVA_OPTS=-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=localhost:5050
----

=== Formats

The input format is derived from the extension, or can be explicitly specified with the `-f <format>` option.

.Formats
[cols="1,2m"]
|===
| Format | Extensions

| CSV | .csv
| TSV | .tsv
| JSON | .json
| Ion | .ion .10n
|===

