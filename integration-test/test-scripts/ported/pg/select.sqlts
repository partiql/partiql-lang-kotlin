
/*
 * Copyright 2019 Amazon.com, Inc. or its affiliates.  All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License").
 *  You may not use this file except in compliance with the License.
 * A copy of the License is located at:
 *
 *      http://aws.amazon.com/apache2.0/
 *
 *  or in the "license" file accompanying this file. This file is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific
 *  language governing permissions and limitations under the License.
 */

 // Ported from https://github.com/postgres/postgres/blob/master/src/test/regress/sql/select.sql

set_default_environment::"select.ion"

test::{
  name:"PG_SELECT_01",
  sql:"SELECT * FROM onek WHERE onek.unique1 < 10",
  expected:result::(bag
    {
      unique1:9,
      unique2:49,
      two:1,
      four:1,
      ten:9,
      twenty:9,
      hundred:9,
      thousand:9,
      twothousand:9,
      fivethous:9,
      tenthous:9,
      odd:18,
      even:19,
      stringu1:"JAAAAA",
      stringu2:"XBAAAA",
      string4:"HHHHxx"
    }
    {
      unique1:1,
      unique2:214,
      two:1,
      four:1,
      ten:1,
      twenty:1,
      hundred:1,
      thousand:1,
      twothousand:1,
      fivethous:1,
      tenthous:1,
      odd:2,
      even:3,
      stringu1:"BAAAAA",
      stringu2:"GIAAAA",
      string4:"OOOOxx"
    }
    {
      unique1:2,
      unique2:326,
      two:0,
      four:2,
      ten:2,
      twenty:2,
      hundred:2,
      thousand:2,
      twothousand:2,
      fivethous:2,
      tenthous:2,
      odd:4,
      even:5,
      stringu1:"CAAAAA",
      stringu2:"OMAAAA",
      string4:"OOOOxx"
    }
    {
      unique1:3,
      unique2:431,
      two:1,
      four:3,
      ten:3,
      twenty:3,
      hundred:3,
      thousand:3,
      twothousand:3,
      fivethous:3,
      tenthous:3,
      odd:6,
      even:7,
      stringu1:"DAAAAA",
      stringu2:"PQAAAA",
      string4:"VVVVxx"
    }
    {
      unique1:5,
      unique2:541,
      two:1,
      four:1,
      ten:5,
      twenty:5,
      hundred:5,
      thousand:5,
      twothousand:5,
      fivethous:5,
      tenthous:5,
      odd:10,
      even:11,
      stringu1:"FAAAAA",
      stringu2:"VUAAAA",
      string4:"HHHHxx"
    }
    {
      unique1:7,
      unique2:647,
      two:1,
      four:3,
      ten:7,
      twenty:7,
      hundred:7,
      thousand:7,
      twothousand:7,
      fivethous:7,
      tenthous:7,
      odd:14,
      even:15,
      stringu1:"HAAAAA",
      stringu2:"XYAAAA",
      string4:"VVVVxx"
    }
    {
      unique1:8,
      unique2:653,
      two:0,
      four:0,
      ten:8,
      twenty:8,
      hundred:8,
      thousand:8,
      twothousand:8,
      fivethous:8,
      tenthous:8,
      odd:16,
      even:17,
      stringu1:"IAAAAA",
      stringu2:"DZAAAA",
      string4:"HHHHxx"
    }
    {
      unique1:4,
      unique2:833,
      two:0,
      four:0,
      ten:4,
      twenty:4,
      hundred:4,
      thousand:4,
      twothousand:4,
      fivethous:4,
      tenthous:4,
      odd:8,
      even:9,
      stringu1:"EAAAAA",
      stringu2:"BGBAAA",
      string4:"HHHHxx"
    }
    {
      unique1:6,
      unique2:978,
      two:0,
      four:2,
      ten:6,
      twenty:6,
      hundred:6,
      thousand:6,
      twothousand:6,
      fivethous:6,
      tenthous:6,
      odd:12,
      even:13,
      stringu1:"GAAAAA",
      stringu2:"QLBAAA",
      string4:"OOOOxx"
    }
    {
      unique1:0,
      unique2:998,
      two:0,
      four:0,
      ten:0,
      twenty:0,
      hundred:0,
      thousand:0,
      twothousand:0,
      fivethous:0,
      tenthous:0,
      odd:0,
      even:1,
      stringu1:"AAAAAA",
      stringu2:"KMBAAA",
      string4:"OOOOxx"
    }
  )
}

test::{
  name:"PG_SELECT_02",
  sql:"SELECT onek.unique1, onek.stringu1 FROM onek WHERE onek.unique1 < 20",
  expected:result::(bag
    {
      unique1:9,
      stringu1:"JAAAAA"
    }
    {
      unique1:14,
      stringu1:"OAAAAA"
    }
    {
      unique1:13,
      stringu1:"NAAAAA"
    }
    {
      unique1:1,
      stringu1:"BAAAAA"
    }
    {
      unique1:19,
      stringu1:"TAAAAA"
    }
    {
      unique1:2,
      stringu1:"CAAAAA"
    }
    {
      unique1:3,
      stringu1:"DAAAAA"
    }
    {
      unique1:10,
      stringu1:"KAAAAA"
    }
    {
      unique1:5,
      stringu1:"FAAAAA"
    }
    {
      unique1:12,
      stringu1:"MAAAAA"
    }
    {
      unique1:7,
      stringu1:"HAAAAA"
    }
    {
      unique1:8,
      stringu1:"IAAAAA"
    }
    {
      unique1:18,
      stringu1:"SAAAAA"
    }
    {
      unique1:11,
      stringu1:"LAAAAA"
    }
    {
      unique1:4,
      stringu1:"EAAAAA"
    }
    {
      unique1:15,
      stringu1:"PAAAAA"
    }
    {
      unique1:17,
      stringu1:"RAAAAA"
    }
    {
      unique1:16,
      stringu1:"QAAAAA"
    }
    {
      unique1:6,
      stringu1:"GAAAAA"
    }
    {
      unique1:0,
      stringu1:"AAAAAA"
    }
  )
}

test::{
  name:"PG_SELECT_03",
  sql:"SELECT * from onek2 where unique2 = 11 and stringu1 < 'B'",
  expected:result::(bag
    {
      unique1:494,
      unique2:11,
      two:0,
      four:2,
      ten:4,
      twenty:14,
      hundred:4,
      thousand:94,
      twothousand:94,
      fivethous:494,
      tenthous:494,
      odd:8,
      even:9,
      stringu1:"ATAAAA",
      stringu2:"LAAAAA",
      string4:"VVVVxx"
    }
  )
}

test::{
  name:"PG_SELECT_04",
  sql:"SELECT * from onek2 where unique2 = 11 and stringu1 = 'ATAAAA'",
  expected:result::(bag
    {
      unique1:494,
      unique2:11,
      two:0,
      four:2,
      ten:4,
      twenty:14,
      hundred:4,
      thousand:94,
      twothousand:94,
      fivethous:494,
      tenthous:494,
      odd:8,
      even:9,
      stringu1:"ATAAAA",
      stringu2:"LAAAAA",
      string4:"VVVVxx"
    }
  )
}

test::{
  name:"PG_SELECT_05",
  sql:"SELECT onek.unique1, onek.string4 FROM onek WHERE onek.unique1 < 10",
  expected:result::(bag
    {
      unique1:9,
      string4:"HHHHxx"
    }
    {
      unique1:1,
      string4:"OOOOxx"
    }
    {
      unique1:2,
      string4:"OOOOxx"
    }
    {
      unique1:3,
      string4:"VVVVxx"
    }
    {
      unique1:5,
      string4:"HHHHxx"
    }
    {
      unique1:7,
      string4:"VVVVxx"
    }
    {
      unique1:8,
      string4:"HHHHxx"
    }
    {
      unique1:4,
      string4:"HHHHxx"
    }
    {
      unique1:6,
      string4:"OOOOxx"
    }
    {
      unique1:0,
      string4:"OOOOxx"
    }
  )
}

test::{
  name:"PG_SELECT_06",
  sql:"SELECT onek.unique1, onek.string4 FROM onek WHERE onek.unique1 > 980",
  expected:result::(bag
    {
      unique1:997,
      string4:"HHHHxx"
    }
    {
      unique1:995,
      string4:"AAAAxx"
    }
    {
      unique1:999,
      string4:"AAAAxx"
    }
    {
      unique1:983,
      string4:"AAAAxx"
    }
    {
      unique1:989,
      string4:"VVVVxx"
    }
    {
      unique1:986,
      string4:"HHHHxx"
    }
    {
      unique1:996,
      string4:"OOOOxx"
    }
    {
      unique1:982,
      string4:"AAAAxx"
    }
    {
      unique1:992,
      string4:"VVVVxx"
    }
    {
      unique1:990,
      string4:"HHHHxx"
    }
    {
      unique1:991,
      string4:"OOOOxx"
    }
    {
      unique1:984,
      string4:"VVVVxx"
    }
    {
      unique1:981,
      string4:"AAAAxx"
    }
    {
      unique1:998,
      string4:"HHHHxx"
    }
    {
      unique1:993,
      string4:"HHHHxx"
    }
    {
      unique1:994,
      string4:"VVVVxx"
    }
    {
      unique1:988,
      string4:"OOOOxx"
    }
    {
      unique1:987,
      string4:"OOOOxx"
    }
    {
      unique1:985,
      string4:"OOOOxx"
    }
  )
}

test::{
  name:"PG_SELECT_07",
  sql:"SELECT onek.unique1, onek.stringu1 FROM onek WHERE onek.unique1 > 980",
  expected:result::(bag
    {
      unique1:997,
      stringu1:"JMAAAA"
    }
    {
      unique1:995,
      stringu1:"HMAAAA"
    }
    {
      unique1:999,
      stringu1:"LMAAAA"
    }
    {
      unique1:983,
      stringu1:"VLAAAA"
    }
    {
      unique1:989,
      stringu1:"BMAAAA"
    }
    {
      unique1:986,
      stringu1:"YLAAAA"
    }
    {
      unique1:996,
      stringu1:"IMAAAA"
    }
    {
      unique1:982,
      stringu1:"ULAAAA"
    }
    {
      unique1:992,
      stringu1:"EMAAAA"
    }
    {
      unique1:990,
      stringu1:"CMAAAA"
    }
    {
      unique1:991,
      stringu1:"DMAAAA"
    }
    {
      unique1:984,
      stringu1:"WLAAAA"
    }
    {
      unique1:981,
      stringu1:"TLAAAA"
    }
    {
      unique1:998,
      stringu1:"KMAAAA"
    }
    {
      unique1:993,
      stringu1:"FMAAAA"
    }
    {
      unique1:994,
      stringu1:"GMAAAA"
    }
    {
      unique1:988,
      stringu1:"AMAAAA"
    }
    {
      unique1:987,
      stringu1:"ZLAAAA"
    }
    {
      unique1:985,
      stringu1:"XLAAAA"
    }
  )
}

test::{
  name:"PG_SELECT_08",
  sql:"SELECT unique1, unique2 from onek2 where (unique2 = 11 and stringu1 < 'B') or unique1 = 0",
  expected:result::(bag
    {
      unique1:494,
      unique2:11
    }
    {
      unique1:0,
      unique2:998
    }
  )
}

test::{
  name:"PG_SELECT_09",
  sql:"SELECT unique1, unique2 from onek2 where (unique2 = 11 or unique1 = 0) and stringu1 < 'B'",
  expected:result::(bag
    {
      unique1:494,
      unique2:11
    }
    {
      unique1:0,
      unique2:998
    }
  )
}

test::{
  name:"PG_SELECT_10",
  sql:"SELECT unique2 from onek2 where unique2 = 11 and stringu1 < 'B'",
  expected:result::(bag
    {
      unique2:11
    }
  )
}

test::{
  name:"PG_SELECT_12",
  sql:"SELECT unique2 from onek2 where unique2 = 11 and stringu1 < 'C'",
  expected:result::(bag
    {
      unique2:11
    }
  )
}

test::{
  name:"PG_SELECT_13",
  sql:"SELECT unique2 from onek2 where unique2 = 11 and stringu1 = 'ATAAAA'",
  expected:result::(bag
    {
      unique2:11
    }
  )
}
